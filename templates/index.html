<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="manifest" href="/static/manifest.json" />
    <style>
    @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR&display=swap');

body {
    position: relative;
    height: 100vh;
    margin: 0;
    background-color: #f7f7f7;
    background-image: url(/static/img/dddd.png);
    background-size: 70%;
    background-repeat: no-repeat;
    background-position: center;
    font-family: 'Noto Sans KR', sans-serif;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
}

@media screen and (min-width: 1024px) {
    body {
        background-size: 30%;
    }
}

@media screen and (max-width: 600px) {
    body {
        background-size: 70%;
    }
}

#title-bar {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    background: linear-gradient(to right, #a7ceee, #1077dd);
    color: #3B1E1E;
    border-radius: 20px;
    padding: 10px 0;
    font-size: 1.2em;
    font-weight: bold;
    z-index: 1000;
    display: flex;
    align-items: center;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    height: 34px;
}

#chat-box {
    position: fixed;
    top: 60px;
    bottom: 120px;
    width: 100%;
    background-color: transparent;
    display: flex;
    flex-direction: column;
    overflow-y: auto;
}

#messages {
    padding: 10px;
    flex-grow: 1;
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
}

#chat-form {
    position: fixed;
    bottom: 0;
    width: 100%;
    display: flex;
    align-items: center;
    border-top: 1px solid #E5E5E5;
    padding: 5px 10px;
    background-color: #F7F7F7;
    z-index: 1001;
}

#chat-form input[type="text"] {
    flex-grow: 1;
    padding: 10px 12px;
    border: none;
    border-radius: 25px;
    background-color: #FFFFFF;
    font-size: 1em;
    margin-right: 10px;
}

#chat-form input[type="text"]:focus {
    outline: none;
}
    </style>
    <script>
        function submitMessage() {
            var input = document.getElementById("input-message");
            var message = input.value;
            input.value = "";

            var userMessageElement = document.createElement("div");
            userMessageElement.innerHTML = "<b>사용자:</b> " + message;
            document.getElementById("messages").appendChild(userMessageElement);

            fetch("/chat", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ question: message })
            })
            .then(response => response.json())
            .then(data => {
                var botMessageElement = document.createElement("div");
                botMessageElement.innerHTML = "<b>챗봇:</b> " + data.answer;
                document.getElementById("messages").appendChild(botMessageElement);
            })
            .catch(error => {
                console.error("오류 발생:", error);
                var errorMessageElement = document.createElement("div");
                errorMessageElement.innerHTML = "<b>챗봇:</b> 오류가 발생했습니다. 다시 시도해주세요.";
                document.getElementById("messages").appendChild(errorMessageElement);
            });
        }
    </script>
</head>
<body>
    <div id="splash-screen">
        <img src="/static/img/splash.png" alt="" />
    </div>

    <div id="title-bar">
        <img src="/static/img/150new.png" alt="Logo" id="logo">
        <span id="title-text">청렴 챗봇 Praxis</span>
    </div>

    <div id="chat-box">
        <div id="messages"></div>
    </div>
    
    <form id="chat-form" onsubmit="event.preventDefault(); submitMessage()">
        <input type="text" id="input-message" placeholder="메시지를 입력하세요" required autocomplete="off">
        <button type="submit">➤</button>
    </form>
</body>
</html>
